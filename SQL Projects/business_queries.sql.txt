-- 1. Top spending customers
SELECT c.name, SUM(o.amount) AS total_spent
FROM Customers c
JOIN Orders o ON c.customer_id = o.customer_id
GROUP BY c.name
ORDER BY total_spent DESC;

-- 2. City with highest total orders
SELECT c.city, COUNT(*) AS total_orders
FROM Orders o
JOIN Customers c ON o.customer_id = c.customer_id
GROUP BY c.city
ORDER BY total_orders DESC;

-- 3. Revenue per restaurant category
SELECT r.category, SUM(o.amount) AS total_revenue
FROM Orders o
JOIN Restaurants r ON o.restaurant_id = r.restaurant_id
GROUP BY r.category
ORDER BY total_revenue DESC;

-- 4. Most used delivery partner
SELECT delivery_partner, COUNT(*) AS deliveries
FROM Orders
GROUP BY delivery_partner
ORDER BY deliveries DESC;
